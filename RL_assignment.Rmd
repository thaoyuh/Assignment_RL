---
title: "Reinforcement Learning Group Assignment"
author: "Group ..."
date: "Februra 2024"
output:
  pdf_document:
    fig_caption: yes
header-includes:
  \usepackage{float}
  \usepackage{booktabs} % To thicken table lines
  \usepackage{unicode-math}

---

```{r, echo = T, results = 'hide', message=FALSE}
# Packes required for subsequent analysis. P_load ensures these will be installed and loaded.
if (!require("pacman")) install.packages("pacman")
pacman::p_load(dplyr,
               tidyr,
               ggplot2,
               reshape2,
               latex2exp
               )

# If you do not have tinytex installed, uncomment the command below for knitting the pdf
#tinytex::install_tinytex()

```

```{r, load data}
# reads in data full
dfZozo40 <- read.csv('zozo_Context_40items.csv')
dfZozo80 <- read.csv('zozo_Context_80items.csv')


```





\section*{Question d)}
```{r }
# Load necessary libraries
library(lubridate)

# Assuming your dataframe is named dfZozo40
# Convert timestamp column to date
dfZozo40$date <- as.Date(dfZozo40$timestamp)
dfZozo40$hour <- hour(dfZozo40$timestamp)

# Group by items per hour and item, count the proportion of 1 occurrences in the click column
result <- dfZozo40 %>%
  group_by(date, item_id) %>%
  summarize(proportion_1 = mean(click == 1, na.rm = TRUE)) %>%
  ungroup() %>%
  spread(key = item_id, value = proportion_1, fill = 0)

# View the result
print(result)
```

```{r stationarity testing} 
# Load necessary libraries
library(urca)

# Initialize an empty dataframe to store test results
test_results_df <- data.frame()

# Loop over columns starting from the second column
for (i in 2:ncol(result)) {
  # Apply ADF test to the current column
  test_result <- ur.df(result[[3]], type = "none", selectlags = "AIC")
  # Extract the test statistic from the ADF test result and store in the dataframe
  test_statistic <- test_result@teststat
  critical_values <- as.numeric(test_result@cval[2])
  
  # Compare the test statistic with the critical values
  if (test_statistic > critical_values) {
    stationarity <- "Stationary"
  } else {
    stationarity <- "Non-Stationary"
  }
  
  # Store the results in the dataframe
  test_results_df <- rbind(test_results_df, data.frame(Item = colnames(result)[i], 
                                                      Test_Statistic = test_statistic,
                                                      Stationarity = stationarity))
}

# Print the dataframe containing test results
print(test_results_df) # stationary if the value is lower than the threshold -1.95 (0.05 significance level)
```
